<!doctype html><html><body>
<h1> AGRORAC </h1>
</body></html>
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FTA Cacao - AGRORAC</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React 18 -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel para JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-white text-gray-800">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // ===========================
    // DATOS (puedes ampliar libremente)
    // Estructura de cada fila:
    // { elem, ini, fin, riesgos: { deficit, exceso, Tmax, Tmin }, ref }
    // ===========================
    const MATRIZ_VEGETATIVA = [
      {
        elem: "Establecimiento del sombr√≠o (permanente y transitorio)",
        ini: 1, fin: 6,
      },
      {
        elem: "Preparaci√≥n del terreno (trazado, ahoyado y drenajes)",
        ini: 6, fin: 6,
        riesgos: {
          deficit: "Deficiencia de nutrientes esenciales debido a la baja disponibilidad ed√°fica de las enmiendas y agua para la absorci√≥n; Baja eficiencia en la incorporaci√≥n de enmiendas; Reducci√≥n en la actividad microbiana, afectando la mineralizaci√≥n de materia org√°nica.",
          exceso: "Saturaci√≥n, erosi√≥n, compactaci√≥n y p√©rdida de nutrientes.",
          Tmax: "Evaporaci√≥n r√°pida; descomposici√≥n acelerada.",
          Tmin: "Baja actividad microbiana y lenta descomposici√≥n de MO."
        },
        ref: "Opoku (2024)."
      },
      {
        elem: "Aplicaci√≥n de enmiendas (correcci√≥n de acidez y org√°nica)",
        ini: 6, fin: 6,
        riesgos: {
          deficit: "Baja eficiencia en incorporaci√≥n; menor disponibilidad de enmiendas.",
          exceso: "Lixiviaci√≥n/escorrent√≠a; anegamiento; fermentaci√≥n anaerobia de MO.",
          Tmax: "Volatilizaci√≥n de N; estr√©s t√©rmico a microbios del suelo.",
          Tmin: "Retraso de efectos por baja actividad microbiana."
        },
        ref: "Opoku (2024); Rodriguez (2015)."
      },
      {
        elem: "Establecimiento en campo",
        ini: 7, fin: 7,
        riesgos: {
          deficit: "Deshidrataci√≥n de pl√°ntulas; lenta activaci√≥n radicular.",
          exceso: "Anoxia en hoyo; ‚ÜëPhytophthora/Pythium/Fusarium; lavado de N.",
          Tmax: "Marchitez al mediod√≠a; da√±o en hojas j√≥venes.",
          Tmin: "Crecimiento lento y mayor susceptibilidad a pat√≥genos de cuello/ra√≠z."
        },
        ref: "Rodriguez (2015)."
      },
      {
        elem: "Deschuponado (cada mes)",
        ini: 9, fin: 16,
        riesgos: {
          deficit: "Cicatrizaci√≥n lenta; baja brotaci√≥n posterior.",
          exceso: "Alta humedad en heridas ‚Üëhongos (Phytophthora, Ceratocystis).",
          Tmax: "Quemadura de heridas; estr√©s t√©rmico limita regeneraci√≥n.",
          Tmin: "Cicatrizaci√≥n muy lenta; ‚Üësusceptibilidad a pat√≥genos."
        },
        ref: "Rodriguez (2015)."
      },
      {
        elem: "Ra√≠ces",
        ini: 6, fin: 23,
        riesgos: {
          deficit: "Menor absorci√≥n de agua/nutrientes; potencial h√≠drico m√°s negativo.",
          exceso: "Asfixia radicular; Phytophthora.",
          Tmax: "Cavitaci√≥n (burbujas) en xilema; da√±o en ra√≠ces superficiales.",
          Tmin: "‚ÜìActividad radicular."
        },
        ref: "Opoku (2024); Paredes (2003)."
      },
      {
        elem: "Hojas",
        ini: 6, fin: 23,
        riesgos: {
          deficit: "Defoliaci√≥n; cierre estom√°tico ‚Üí ‚ÜìCO‚ÇÇ.",
          exceso: "‚ÜëPhytophthora/Antracnosis.",
          Tmax: "Marchitez; ‚Üëdensidad estom√°tica; ‚Üìfotos√≠ntesis por fotorrespiraci√≥n.",
          Tmin: "‚ÜìActividad enzim√°tica."
        },
        ref: "Opoku (2024); Rodriguez (2015)."
      },
    ];

    const MATRIZ_PRODUCTIVA = [
      {
        elem: "Fertilizaci√≥n ed√°fica 1",
        ini: 9, fin: 9,
        riesgos: {
          deficit: "Baja absorci√≥n de nutrientes.",
          exceso: "P√©rdida por lixiviaci√≥n; posible anegamiento.",
          Tmax: "‚Äî",
          Tmin: "‚Äî"
        },
        ref: "Rodriguez (2015)."
      },
      {
        elem: "Deschuponado (cada mes)",
        ini: 9, fin: 16,
        riesgos: {
          deficit: "Menor capacidad de cicatrizar; menor brotaci√≥n.",
          exceso: "Heridas h√∫medas favorecen pat√≥genos.",
          Tmax: "Quemadura de heridas; estr√©s t√©rmico.",
          Tmin: "Cicatrizaci√≥n lenta; ‚Üëriesgo de infecci√≥n."
        },
        ref: "Rodriguez (2015)."
      },
      {
        elem: "Floraci√≥n",
        ini: 4, fin: 6,
        riesgos: {
          deficit: "P√©rdida/aborto floral; menos n√©ctar; baja polinizaci√≥n.",
          exceso: "Hipoxia; ‚ÜëPhytophthora/Colletotrichum; lavado de n√©ctar/polen.",
          Tmax: "Menor viabilidad floral; polen menos viable; apertura incompleta.",
          Tmin: "Ralentiza metabolismo; baja producci√≥n de n√©ctar y hormonas."
        },
        ref: "Osorio (2021); Opoku (2024); Agudelo (2021)."
      },
      {
        elem: "Polinizaci√≥n y fecundaci√≥n",
        ini: 5, fin: 7,
        riesgos: {
          deficit: "Menor actividad de polinizadores.",
          exceso: "Menor √©xito de polinizaci√≥n.",
          Tmax: "‚Äî",
          Tmin: "‚Üìmovilidad de polinizadores."
        },
        ref: "Agudelo (2021)."
      },
      {
        elem: "Cuajado de frutos",
        ini: 5, fin: 8,
        riesgos: {
          deficit: "Menor retenci√≥n; abortos; menor desarrollo del grano.",
          exceso: "Aborto de frutos j√≥venes; ‚ÜëMoniliasis.",
          Tmax: "Maduraci√≥n acelerada; frutos peque√±os; Phytophthora.",
          Tmin: "Frutos poco desarrollados."
        },
        ref: "Rodriguez (2015)."
      },
      {
        elem: "Crecimiento y maduraci√≥n del fruto",
        ini: 7, fin: 12,
        riesgos: {
          deficit: "Secado acelerado; ‚ÜëCarmenta.",
          exceso: "‚ÜëMoniliasis, Phytophthora y Monalonion; ‚Üìtama√±o del fruto.",
          Tmax: "‚Üìtiempo de maduraci√≥n; cambios en composici√≥n; Phytophthora.",
          Tmin: "‚Äî"
        },
        ref: "Daymond (2007); Rodriguez (2015)."
      },
      {
        elem: "Cosecha",
        ini: 9, fin: 12,
        riesgos: {
          deficit: "Retraso en maduraci√≥n.",
          exceso: "Cosecha dif√≠cil por humedad.",
          Tmax: "Calidad del grano afectada; variaci√≥n en rutas enzim√°ticas.",
          Tmin: "‚Äî"
        },
        ref: "Daymond (2007); Rodriguez (2015)."
      },
      {
        elem: "Postcosecha ‚Äì Fermentaci√≥n",
        ini: 1, fin: 12,
        riesgos: {
          deficit: "‚Äî",
          exceso: "Fermentaci√≥n inadecuada; desarrollo de mohos.",
          Tmax: "‚Äî",
          Tmin: "Fermentaci√≥n lenta; menor desarrollo de sabor."
        },
        ref: "‚Äî"
      },
    ];

    // ===========================
    // COMPONENTES
    // ===========================
    function Intro({ onStart }) {
      return (
        <div className="max-w-5xl mx-auto p-6 space-y-6">
          <header className="space-y-2">
            <h1 className="text-3xl font-semibold">¬øQu√© es una Ficha T√©cnica Agroclim√°tica (FTA)?</h1>
            <p className="text-gray-700">
              Una FTA organiza y sintetiza los principales <b>riesgos agroclim√°ticos</b> que afectan un cultivo.
              Identifica <b>elementos expuestos</b> (ra√≠ces, tallo, floraci√≥n, pr√°cticas de manejo) y los relaciona con
              <b> amenazas clim√°ticas</b> como <i>d√©ficit y exceso h√≠drico</i> y <i>temperaturas extremas</i>. Sirve para anticipar tomar mejores decisiones de manejo oportuno.
            </p>
            <div className="p-4 rounded-xl bg-amber-50 text-amber-900">
              <b>Importante:</b> Los campos <i>Mes inicio</i> y <i>Mes fin</i> <b>no son meses de calendario</b>. ‚ÄúMes 1‚Äù es el primer mes del evento dentro del sistema productivo. Por ejemplo, puede coincidir con octubre si all√≠ inicia la preparaci√≥n del terreno. Esto es clave porque las siembras ya no ocurren siempre en las mismas fechas hist√≥ricas.
            </div>
          </header>

          <section className="grid md:grid-cols-2 gap-6">
            <div className="rounded-2xl border p-5">
              <h2 className="font-semibold mb-2">¬øQu√© ver√°n en la matriz?</h2>
              <ul className="list-disc ml-6 text-gray-700 space-y-1">
                <li> Filas = <b>elementos expuestos</b> (fase fenol√≥gica o pr√°cticas agr√≠colas) </li>
                <li>Columnas = <b>D√©fict y exceso h√≠drico y temperaturas extremas </b> (no calendario).</li>
                <li>Amenazas = <b>ventanas de exposici√≥n </b>.</li>
              </ul>
            </div>
            <div className="rounded-2xl border p-5">
              <h2 className="font-semibold mb-2">¬øPara qui√©n?</h2>
              <p className="text-gray-700">
                Para actors del sistema productivo 
              </p>
            </div>
          </section>

          <div className="pt-2">
            <button onClick={onStart}
              className="px-5 py-3 rounded-xl bg-emerald-600 text-white font-medium hover:bg-emerald-700">
              üëâ Explorar matriz de cacao
            </button>
          </div>
        </div>
      );
    }

    function Pill({ children }) {
      return <span className="px-2 py-0.5 rounded-full bg-gray-100 border text-gray-800 text-xs">{children}</span>;
    }

    function PanelDetalle({ fila, onClose }) {
      if (!fila) return null;
      const R = fila.riesgos || {};
      return (
        <div className="fixed inset-0 bg-black/30 backdrop-blur-sm z-40 flex">
          <div className="m-auto w-[95%] max-w-3xl bg-white rounded-2xl shadow-lg p-5">
            <div className="flex items-start justify-between gap-4">
              <h3 className="text-lg font-semibold">{fila.elem}</h3>
              <button onClick={onClose} className="text-gray-500 hover:text-gray-700">‚úï</button>
            </div>
            <p className="text-sm text-gray-600 mb-3">Ventana: M{fila.ini} ‚Äì M{fila.fin}</p>
            <div className="grid md:grid-cols-2 gap-3 text-sm">
              <div className="border rounded-xl p-3"><b>D√©ficit h√≠drico:</b> {R.deficit || "‚Äî"}</div>
              <div className="border rounded-xl p-3"><b>Exceso h√≠drico:</b> {R.exceso || "‚Äî"}</div>
              <div className="border rounded-xl p-3"><b>Tmax:</b> {R.Tmax || "‚Äî"}</div>
              <div className="border rounded-xl p-3"><b>Tmin:</b> {R.Tmin || "‚Äî"}</div>
            </div>
            <p className="text-xs text-gray-500 mt-4"><b>Referencias:</b> {fila.ref || "‚Äî"}</p>
          </div>
        </div>
      );
    }

    function MatrizCacao({ onBack }) {
      const [fase, setFase] = useState("Vegetativa");
      const data = fase === "Vegetativa" ? MATRIZ_VEGETATIVA : MATRIZ_PRODUCTIVA;
      const [sel, setSel] = useState(null);

      const maxMes = useMemo(() => Math.max(...data.map(d => d.fin)), [data]);
      const meses = useMemo(() => Array.from({length: maxMes}, (_,i) => i+1), [maxMes]);

      return (
        <div className="max-w-7xl mx-auto p-6 space-y-6">
          <header className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div>
              <h1 className="text-2xl font-semibold">Matriz preliminar de riesgos agroclim√°ticos ¬∑ Cacao</h1>
              <p className="text-sm text-gray-600">
                Los meses representan <b>fases del ciclo</b>, no un calendario fijo. ‚ÄúMes 1‚Äù = primer mes del evento en campo.
              </p>
            </div>
            <div className="flex items-center gap-2">
              <button onClick={onBack} className="px-3 py-2 border rounded-lg text-sm">‚Üê Volver</button>
              <label className="text-sm text-gray-600">Fase:</label>
              <select value={fase} onChange={e => setFase(e.target.value)}
                      className="border rounded-lg px-3 py-2 text-sm">
                <option>Vegetativa</option>
                <option>Productiva</option>
              </select>
            </div>
          </header>

          <div className="overflow-auto border rounded-2xl">
            <table className="min-w-full text-sm">
              <thead>
                <tr className="bg-gray-50">
                  <th className="text-left px-3 py-2 sticky left-0 bg-gray-50 z-10">Elemento expuesto</th>
                  {meses.map(m => <th key={m} className="px-3 py-2 text-center border-l">M{m}</th>)}
                </tr>
              </thead>
              <tbody>
                {data.map((row, i) => {
                  const activo = (m) => m >= row.ini && m <= row.fin;
                  return (
                    <tr key={i} className={i%2 ? "bg-white" : "bg-gray-50/50 hover:bg-emerald-50"}>
                      <td className="px-3 py-2 sticky left-0 bg-inherit max-w-[360px]">
                        <button onClick={() => setSel(row)} className="text-left hover:underline">
                          {row.elem}
                        </button>
                      </td>
                      {meses.map((m, j) =>
                        <td key={j} className={`h-9 border-l ${activo(m) ? "bg-emerald-200" : ""}`}></td>
                      )}
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>

          <section className="text-xs text-gray-600">
            <div className="flex items-center gap-2">
              <Pill>D√©ficit h√≠drico</Pill>
              <Pill>Exceso h√≠drico</Pill>
              <Pill>Tmax</Pill>
              <Pill>Tmin</Pill>
            </div>
            <p className="mt-2">Haz clic en el nombre de la fila para ver el detalle y las referencias.</p>
          </section>

          <PanelDetalle fila={sel} onClose={() => setSel(null)} />
        </div>
      );
    }

    function App() {
      const [paso, setPaso] = useState("intro");
      return paso === "intro"
        ? <Intro onStart={() => setPaso("matriz")} />
        : <MatrizCacao onBack={() => setPaso("intro")} />;
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>

